{"version":3,"file":"wtf-plugin-wikitext.js","sources":["../src/01-doc.js","../src/02-section.js","../src/03-paragraph.js","../src/_lib/smartReplace.js","../src/04-sentence.js","../src/05-link.js","../src/image.js","../src/infobox.js","../src/list.js","../src/reference.js","../src/table.js","../src/index.js"],"sourcesContent":["const defaults = {\n  images: true,\n  tables: true,\n  infoboxes: true,\n  categories: true,\n  lists: true,\n  links: true,\n  paragraphs: true\n}\nconst toWiki = function (options) {\n  options = options || {}\n  options = Object.assign({}, defaults, options)\n  let text = ''\n\n  //if it's a redirect page\n  if (this.isRedirect() === true) {\n    return `#REDIRECT [[${this.redirectTo().page}]]`\n  }\n\n  //render infoboxes (up at the top)\n  if (options.infoboxes === true) {\n    text += this.infoboxes()\n      .map((i) => i.wikitext(options))\n      .join('\\n')\n  }\n\n  //render each section\n  if (options.sections === true || options.paragraphs === true || options.sentences === true) {\n    let sections = this.sections()\n    // sections = sections.filter((s) => s.title() !== 'References')\n    text += sections.map((s) => s.wikitext(options)).join('\\n')\n  }\n\n  // add categories on the bottom\n  if (options.categories === true) {\n    text += '\\n'\n    this.categories().forEach((cat) => (text += `\\n[[Category: ${cat}]]`))\n  }\n  return text\n}\nmodule.exports = toWiki\n","const defaults = {}\n\nconst doTemplate = function (obj) {\n  let data = ''\n  let name = obj.template\n  Object.keys(obj).forEach((k) => {\n    if (k !== 'template') {\n      data += ` | ${k} = ${obj[k]}`\n    }\n  })\n  return `{{${name}${data}}} `\n}\n\nconst toWiki = function (options) {\n  options = options || {}\n  options = Object.assign({}, defaults, options)\n  let text = ''\n  if (this.title()) {\n    let side = '=='\n    text += `\\n${side} ${this.title()} ${side}\\n`\n  }\n  // render some templates?\n  this.templates().forEach((tmpl) => {\n    text += doTemplate(tmpl) + '\\n'\n  })\n\n  //make a table\n  if (options.tables === true) {\n    text += this.tables()\n      .map((t) => t.wikitext(options))\n      .join('\\n')\n  }\n\n  // make a html bullet-list\n  if (options.lists === true) {\n    text += this.lists()\n      .map((list) => list.text(options))\n      .join('\\n')\n  }\n  text += this.paragraphs()\n    .map((p) => {\n      return p.wikitext(options)\n    })\n    .join('\\n')\n\n  // render references\n  // these will be out of place\n  this.references().forEach((ref) => {\n    text += ref.wikitext(options) + '\\n'\n  })\n\n  return text\n}\nmodule.exports = toWiki\n","const defaults = {}\n\nconst toWiki = function (options) {\n  options = options || {}\n  options = Object.assign({}, defaults, options)\n  let text = ''\n\n  // do images\n  this.images().forEach((img) => {\n    text += img.wikitext()\n  })\n  // do lists\n  this.lists().forEach((list) => {\n    text += list.wikitext()\n  })\n  // render sentences\n  text += this.sentences()\n    .map((s) => {\n      return s.wikitext(options)\n    })\n    .join('\\n')\n  return text\n}\nmodule.exports = toWiki\n","//escape a string like 'fun*2.Co' for a regExpr\nfunction escapeRegExp(string) {\n  return string.replace(/[.*+?^${}()|[\\]\\\\]/g, '\\\\$&') // $& means the whole matched string\n}\n\n//sometimes text-replacements can be ambiguous - words used multiple times..\nconst smartReplace = function (all, text, result) {\n  if (!text || !all) {\n    return all\n  }\n\n  if (typeof all === 'number') {\n    all = String(all)\n  }\n  text = escapeRegExp(text)\n  //try a word-boundary replace\n  let reg = new RegExp('\\\\b' + text + '\\\\b')\n  if (reg.test(all) === true) {\n    all = all.replace(reg, result)\n  } else {\n    //otherwise, fall-back to a much messier, dangerous replacement\n    // console.warn('missing \\'' + text + '\\'');\n    all = all.replace(text, result)\n  }\n  return all\n}\n\nmodule.exports = smartReplace\n","const smartReplace = require('./_lib/smartReplace')\n\nconst defaults = {\n  links: true\n}\n\nconst toWiki = function (options) {\n  options = options || {}\n  options = Object.assign({}, defaults, options)\n  let text = this.text()\n  if (options.links === true) {\n    this.links().forEach((link) => {\n      let str = link.text() || link.page()\n      let tag = link.wikitext()\n      text = smartReplace(text, str, tag)\n    })\n  }\n  if (options.formatting === true) {\n    //support bolds\n    this.bold().forEach((str) => {\n      let tag = '**' + str + '**'\n      text = smartReplace(text, str, tag)\n    })\n    //do italics\n    this.italic().forEach((str) => {\n      let tag = '***' + str + '***'\n      text = smartReplace(text, str, tag)\n    })\n  }\n\n  return text\n}\nmodule.exports = toWiki\n","// add `[text](href)` to the text\nconst toWiki = function () {\n  //if it's an external link, we good\n  if (this.site()) {\n    if (this.text()) {\n      return `[${this.site()}|${this.text()}]`\n    }\n    return `[${this.site()}]`\n  }\n  let page = this.page() || ''\n  if (this.anchor()) {\n    page += `#${this.anchor()}`\n  }\n\n  let str = this.text() || ''\n  if (str && str.toLowerCase() !== page.toLowerCase()) {\n    return `[[${page}|${str}]]`\n  }\n  return `[[${page}]]`\n}\nmodule.exports = toWiki\n","const toWiki = function () {\n  let text = `[[${this.file()}|thumb`\n  let caption = this.data.caption\n  if (caption) {\n    text += `|${this.data.caption.wikitext()}`\n  }\n  return text + ']]'\n}\nmodule.exports = toWiki\n","const toWiki = function () {\n  let text = `{{Infobox ${this._type || ''}\\n`\n  Object.keys(this.data).forEach((k) => {\n    let val = this.data[k]\n    if (val) {\n      text += `| ${k} = ${val.wikitext() || ''}\\n`\n    }\n  })\n  text += '}}\\n'\n  return text\n}\nmodule.exports = toWiki\n","const toWiki = function () {\n  let txt = ''\n  this.lines().forEach((s) => {\n    txt += `* ${s.wikitext()}\\n`\n  })\n  return txt\n}\nmodule.exports = toWiki\n","const toWiki = function () {\n  if (this.data.inline) {\n    return `<ref>${this.data.inline.wikitext()}</ref>`\n  }\n  let type = this.data.type || 'cite web'\n  let data = ''\n  Object.keys(this.data).forEach((k) => {\n    if (k !== 'template' && k !== 'type') {\n      data += ` | ${k} = ${this.data[k]}`\n    }\n  })\n  return `<ref>{{${type}${data}}}</ref>`\n}\nmodule.exports = toWiki\n","const toWiki = function (options) {\n  let rows = this.data\n  let wiki = `{| class=\"wikitable\"\\n`\n\n  // draw headers\n  let headers = Object.keys(rows[0])\n  headers = headers.filter((k) => /^col[0-9]/.test(k) !== true)\n  if (headers.length > 0) {\n    wiki += '|-\\n'\n    headers.forEach((k) => {\n      wiki += '! ' + k + '\\n'\n    })\n  }\n  //make rows\n  rows.forEach((o) => {\n    wiki += '|-\\n'\n    Object.keys(o).forEach((k) => {\n      let val = o[k].wikitext(options)\n      wiki += '| ' + val + '\\n'\n    })\n  })\n  wiki += `|}`\n  return wiki\n}\nmodule.exports = toWiki\n","const doc = require('./01-doc')\nconst section = require('./02-section')\nconst paragraph = require('./03-paragraph')\nconst sentence = require('./04-sentence')\nconst link = require('./05-link')\nconst image = require('./image')\nconst infobox = require('./infobox')\nconst list = require('./list')\nconst reference = require('./reference')\nconst table = require('./table')\n\nconst plugin = function (models) {\n  models.Doc.prototype.wikitext = doc\n  models.Section.prototype.wikitext = section\n  models.Paragraph.prototype.wikitext = paragraph\n  models.Sentence.prototype.wikitext = sentence\n  models.Link.prototype.wikitext = link\n  models.Image.prototype.wikitext = image\n  models.Infobox.prototype.wikitext = infobox\n  models.Table.prototype.wikitext = table\n  models.List.prototype.wikitext = list\n  models.Reference.prototype.wikitext = reference\n}\nmodule.exports = plugin\n"],"names":["defaults","images","tables","infoboxes","categories","lists","links","paragraphs","toWiki","options","Object","assign","text","isRedirect","redirectTo","page","map","i","wikitext","join","sections","sentences","s","forEach","cat","doTemplate","obj","data","name","template","keys","k","title","side","templates","tmpl","t","list","p","references","ref","img","escapeRegExp","string","replace","smartReplace","all","result","String","reg","RegExp","test","link","str","tag","formatting","bold","italic","site","anchor","toLowerCase","file","caption","_type","val","txt","lines","inline","type","rows","wiki","headers","filter","length","o","plugin","models","Doc","prototype","doc","Section","section","Paragraph","paragraph","Sentence","sentence","Link","Image","image","Infobox","infobox","Table","table","List","Reference","reference"],"mappings":"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"}